<!DOCTYPE html>
<html lang="en">
<head>
        <title>The soft jaguar</title>
    <meta charset="utf-8" />
    <meta name="description" content="Darío Blanco webpage">
    <meta name="author" content="Darío Blanco">
    <link href="../../../../../theme/css/bootstrap.min.css" rel="stylesheet">
    <link href="../../../../../theme/css/darioblanco.css" rel="stylesheet">
    <link href="../../../../../theme/css/pygments.css" rel="stylesheet">
    <style> body { padding-top: 60px; }</style>
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
        <link href="http://thesoftjaguar.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="The soft jaguar Full Atom Feed" />
            <link href="http://thesoftjaguar.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="The soft jaguar Full RSS Feed" />
                    <link href="http://thesoftjaguar.com/feeds/programming.atom.xml" type="application/atom+xml" rel="alternate" title="The soft jaguar Categories Atom Feed" />
            <link href="http://thesoftjaguar.com/feeds/programming.rss.xml" type="application/rss+xml" rel="alternate" title="The soft jaguar Categories RSS Feed" />
            <link href="http://thesoftjaguar.com/feeds/.atom.xml" type="application/atom+xml" rel="alternate" title="The soft jaguar Tags Atom Feed" />
            <link href="http://thesoftjaguar.com/feeds/.rss.xml" type="application/rss+xml" rel="alternate" title="The soft jaguar Tags RSS Feed" />
        </head>

<body>
            <div class="navbar navbar-inverse navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="../../../../../index.html">The soft jaguar</a>
      <div class="nav-collapse collapse">
        <ul class="nav">
                        <li id="blog-tab" class="navbar-tab active"><a href="../../../../../index.html"><i class="icon-pencil icon-white"></i> Blog</a></li>
                        <li id="archive-tab" class="navbar-tab "><a href="../../../../../archives.html"><i class="icon-briefcase icon-white"></i> Archive</a></li>
                        <li id="tags-tab" class="navbar-tab "><a href="../../../../../tags.html"><i class="icon-certificate icon-white"></i> Tags</a></li>
                        <li id="projects-tab" class="navbar-tab "><a href="../../../../../projects.html"><i class="icon-wrench icon-white"></i> Projects</a></li>
                    </ul>
        <ul class="nav pull-right">
            <li><a href="http://www.linkedin.com/in/darioblancoiturriaga" target="_blank" title="LinkedIn"><img width="16" src="../../../../../theme/img/linkedin.png"></a></li>
            <li><a href="https://github.com/sharkerz" target="_blank" title="Github"><img width="16" src="../../../../../theme/img/github.png"></a></li>
            <li><a href="https://www.facebook.com/dario.blancoit" target="_blank" title="Facebook"><img width="16" src="../../../../../theme/img/facebook.png"></a></li>
            <li><a href="https://twitter.com/darioblanco" target="_blank" title="Twitter"><img width="16" src="../../../../../theme/img/twitter.png"></a></li>
            <li><a href="mailto:dario@darioblanco.com" target="_blank" title="Email"><img width="16" src="../../../../../theme/img/email.png"></a></li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </div>
</div>    
    <div class="container">
    <header>
  <h1 class="entry-title">Migrating to a Pelican static blog</h1>

written on <div class="article-date">Saturday, 06 April, 2013</div>
<div class="article-tags">
<span class="label"><a href="/tag/static-blog.html">static-blog</a></span> <span class="label"><a href="/tag/markdown.html">markdown</a></span> <span class="label"><a href="/tag/pelican.html">pelican</a></span> <span class="label"><a href="/tag/python.html">python</a></span> <span class="label"><a href="/tag/web-development.html">web-development</a></span> <span class="label"><a href="/tag/git.html">git</a></span> <span class="label"><a href="/tag/django.html">django</a></span> </div>
</header>
<hr>
<article>
<div class="entry-content">
  <p><p>In October 2011, as a Django training exercise, I decided to develop a blog engine from scratch, and I called it <a href="https://github.com/sharkerz/blogjaguar">blogjaguar</a>. It was quite interesting and I had a lot of fun in the process, but it wasn't easy and updating it required a lot of time, even if the web framework was making the things easier. That's why I have decided to drop its support, and migrate to a static blog, integrating it with a basic bootstrap webpage that I had for my personal portfolio.</p>
<p><img alt="My old blog" src="http://i.imgur.com/uhdrWYn.png" /></p>
<h2>The static blog concept</h2>
<p>Instead of having a server side application which is going to parse the client request given by the web server, compile a template based on the given data (this step can be avoided sometimes with a cache system), and return it as an HTML page, we simply skip the first two steps, serving the static HTML page directly, without any programming language as a proxy.</p>
<p>And there are many questions... How? We don't really need an admin interface for writing a blog post: we can do it directly creating another HTML page. We don't need our own comment system, we can include an external one like <em>Disqus</em>. We don't need to register users in our page, they don't want to register in a blog. There are many tasks that we can do without creating the HTML pages dynamically.</p>
<p>Fine, now you are thinking that this is a mess, why should you be editting the HTML pages every time you want to create a new blog entry? It seems easier with an administration panel and a WYSWYG editor. And that's why we have static blog generators. </p>
<h2>The static blog generator</h2>
<p>There are many static blog generators, and they provide a really interesting set of features:</p>
<ol>
<li><strong>Speed.</strong> The parse is made once locally, and then the static pages are uploaded to the web root, ready to be served.</li>
<li><strong>Portability.</strong> Your source blog pages are going to be written in a markup language like Markdown, Textile or Restructured Text, so we don't care about the design, and can be reused in other static blog engines, or even in other systems.</li>
<li><strong>Security.</strong> It is the strongest point, everything is static, no server side code, no headaches.</li>
<li><strong>Configurability.</strong> They usually have a configuration file, and you can create your own themes in a really easy way, using different template languages.</li>
<li><strong>Power.</strong> <em>Git</em> power can be applied to the static blogs, tracking the changes in each blog post and using post-hooks for deploying both in <em>github</em> or in another web server. Forget about WYSWYG and complex admin interfaces: just use markup language, your favorite text editor and your preferred version control system, and you will be happy.</li>
<li><strong>Cheap.</strong> You actually don't need expensive hosting, you can upload your static content to <em>github</em> and it will serve it for you.</li>
</ol>
<p>Maybe the most famous static blog generator is <a href="https://github.com/mojombo/jekyll">Jekyll</a> (Ruby), but I have enough Ruby when I program with Chef, so I wanted a Python alternative. I tried two: <a href="http://nikola.ralsina.com.ar/">Nikola</a> and <a href="http://docs.getpelican.com/">Pelican</a>.</p>
<p>My colleague <a href="http://ventolin.org/">Aengus Walton</a> has been migrating his Wordpress blog to a static blog philosophy, and for that purpose he recommends Nikola over Pelican, it seems that Nikola handles Wordpress in a better way. I have to say that Nikola is a great alternative, but in my specific case, I decided to use Pelican for this purpose.</p>
<h2>Why Pelican</h2>
<p>With Nikola I had some issues when customizing the blog, so instead of trying to figure out what was going on, I decided to try Pelican.</p>
<p>For me Pelican has everything that I need: comments with Disqus, themes using Jinja2, syntax hightlighting, feeds, Twitter and Google Analytics integration, and publication of articles in multiple languages.</p>
<p>Actually this last point was one of the reasons why I tried Pelican: I thought that it wasn't supporting multilanguage (Nikola does). I didn't have any problem with Pelican in the process, and everything was astonishingly easy, so I didn't consider any other alternative after such a nice experience.</p>
<p><img alt="Pelican? Wat" src="http://i.imgur.com/BgxJhRW.jpg" /></p>
<h2>The process</h2>
<h3>Initializiting the project</h3>
<p>I always recommend using <code>virtualenv</code> and <code>virtualenvwrapper</code>, and then install the required <code>pip</code> packages inside the virtual environment. In this case I am using <code>markdown</code> as a markup format for my blog post, so I am installing it as well:</p>
<div class="codehilite"><pre><span class="nv">$ </span>mkvirtualenv my-pelican-blog -a ~/my-pelican-blog-project-folder
<span class="nv">$ </span>pip install -r pelican markdown
</pre></div>


<p>Once you have set up your virtual environment, the cool part begins. Just run the <code>pelican-quickstart</code> command, and answer each question:</p>
<div class="codehilite"><pre><span class="nv">$ </span>pelican-quickstart
</pre></div>


<p>That's going to create the project layout, putting each blogpost markdown file in the <code>content</code> folder. Running the following command will generate the static HTML files with Pelican's simple theme:</p>
<div class="codehilite"><pre><span class="nv">$ </span>make html
</pre></div>


<p>And well, of course you want to check how the blog is looking like:</p>
<div class="codehilite"><pre><span class="nv">$ </span>make serve
</pre></div>


<h3>Defining Pelican settings</h3>
<p>Now you will see two new files, <code>pelicanconf.py</code> and <code>publishconf.py</code>. They are settings files, filled with the answers that you gave running <code>pelican-quickstart</code>. In my specific case, I tuned them up a bit, for matching my personal requirements.</p>
<p>First of all, I wanted to set <em>DISQUS</em> as external comment system:</p>
<div class="codehilite"><pre><span class="n">DISQUS_SITENAME</span> <span class="o">=</span> <span class="s">&quot;thesoftjaguar&quot;</span>
</pre></div>


<p>I also wanted to arrange the post urls by date, for handling <code>archives</code> later:</p>
<div class="codehilite"><pre><span class="c"># Urls</span>
<span class="n">ARTICLE_URL</span> <span class="o">=</span> <span class="s">&#39;posts/{date:%Y}/{date:%m}/{date:</span><span class="si">%d</span><span class="s">}/{slug}/&#39;</span>
<span class="n">ARTICLE_SAVE_AS</span> <span class="o">=</span> <span class="s">&#39;posts/{date:%Y}/{date:%m}/{date:</span><span class="si">%d</span><span class="s">}/{slug}/index.html&#39;</span>
<span class="n">YEAR_ARCHIVE_SAVE_AS</span> <span class="o">=</span> <span class="s">&#39;posts/{date:%Y}/index.html&#39;</span>
<span class="n">MONTH_ARCHIVE_SAVE_AS</span> <span class="o">=</span> <span class="s">&#39;posts/{date:%Y}/{date:%m}/index.html&#39;</span>
</pre></div>


<p>I activated the feeds for all the posts, categories and tags:</p>
<div class="codehilite"><pre><span class="c"># Feeds</span>
<span class="n">FEED_ALL_ATOM</span> <span class="o">=</span> <span class="s">&#39;feeds/all.atom.xml&#39;</span>
<span class="n">FEED_ALL_RSS</span> <span class="o">=</span> <span class="s">&#39;feeds/all.rss.xml&#39;</span>
<span class="n">CATEGORY_FEED_ATOM</span> <span class="o">=</span> <span class="s">&#39;feeds/</span><span class="si">%s</span><span class="s">.atom.xml&#39;</span>
<span class="n">CATEGORY_FEED_RSS</span> <span class="o">=</span> <span class="s">&#39;feeds/</span><span class="si">%s</span><span class="s">.rss.xml&#39;</span>
<span class="n">TAG_FEED_ATOM</span> <span class="o">=</span> <span class="s">&#39;feeds/</span><span class="si">%s</span><span class="s">.atom.xml&#39;</span>
<span class="n">TAG_FEED_RSS</span> <span class="o">=</span> <span class="s">&#39;feeds/</span><span class="si">%s</span><span class="s">.rss.xml&#39;</span>
</pre></div>


<p>I also had some static pages that were not going to be generated by Pelican, so it has to know that we want to parse them as well:</p>
<div class="codehilite"><pre><span class="n">TEMPLATE_PAGES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;projects.html&#39;</span><span class="p">:</span> <span class="s">&#39;projects.html&#39;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>


<p>Finally, I decided to implement my own theme, using <em>Twitter Bootstrap</em>. Pelican will check in different places for a folder match, and then it will parse the content from that theme folder:</p>
<div class="codehilite"><pre><span class="n">THEME</span> <span class="o">=</span> <span class="s">&#39;bootstrap-theme&#39;</span>
</pre></div>


<h3>Creating your own theme</h3>
<p>If you want some extra customization (like I do), you will create your own theme. <a href="https://github.com/getpelican/pelican/tree/master/pelican/themes">Pelican themes</a> are quite cool, but I already had a really basic page using <em>Twitter bootstrap</em> and I wanted to adapt my old Django blog to that style.</p>
<p>A way of doing this, is to create a folder with your theme name, as it is defined in the <code>THEME</code> setting parameter. In my case I called my theme <code>bootstrap-theme</code>, with two other folders: <code>static</code> and <code>templates</code>. Pelican is requiring a specific <a href="http://docs.getpelican.com/en/3.1.1/themes.html#structure">folder structure</a>.</p>
<p>I copied <a href="https://github.com/getpelican/pelican/tree/master/pelican/themes/simple/templates">simple theme</a> template files into my <code>templates</code> folder, and I editted them. In addition, there is a cool feature in Pelican 3: if it doesn't find a required template file, it will inherit it from the <code>simple</code> theme, so you don't need to store uneditted simple theme files in your custom theme.</p>
<p>Now, you are on your own. You should keep in mind that there are several <a href="http://docs.getpelican.com/en/3.1.1/themes.html#templates-and-variables">template variables</a> that you have to use, but that's it.</p>
<p>However, I found several problems when I wanted to display the blog archives by year and month, and Pelican's documentation is not really clear about that subject. Using Jinja2 <code>groupby</code> filter was my way of solving the problem:</p>
<div class="codehilite"><pre><span class="x">&lt;h1 class=&quot;page-title&quot;&gt;Archive&lt;/h1&gt;</span>
<span class="x">&lt;ul&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">year</span><span class="o">,</span> <span class="nv">year_articles</span> <span class="k">in</span> <span class="nv">articles</span><span class="o">|</span><span class="nf">groupby</span><span class="o">(</span><span class="s1">&#39;date.year&#39;</span><span class="o">)</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    &lt;li&gt;&lt;h2&gt;</span><span class="cp">{{</span> <span class="nv">year</span> <span class="cp">}}</span><span class="x">&lt;/h2&gt;&lt;/li&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">month</span><span class="o">,</span> <span class="nv">month_articles</span> <span class="k">in</span> <span class="nv">year_articles</span><span class="o">|</span><span class="nf">groupby</span><span class="o">(</span><span class="s1">&#39;date.month&#39;</span><span class="o">)</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    &lt;ul&gt;</span>
<span class="x">        &lt;li&gt;&lt;h4&gt;</span><span class="cp">{{</span> <span class="nv">month_articles</span><span class="o">[</span><span class="m">0</span><span class="o">]</span><span class="nv">.date.strftime</span><span class="o">(</span><span class="s1">&#39;%B&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="x">&lt;/h4&gt;&lt;/li&gt;</span>
<span class="x">            </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">article</span> <span class="k">in</span> <span class="nv">month_articles</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">            &lt;div class=&quot;entry-archive&quot;&gt;</span>
<span class="x">                &lt;div class=&quot;date&quot;&gt;</span>
<span class="x">                    </span><span class="cp">{{</span> <span class="nv">article.date.strftime</span><span class="o">(</span><span class="s1">&#39;%A %d&#39;</span><span class="o">)</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">                &lt;/div&gt;</span>
<span class="x">                &lt;div class=&quot;detail&quot;&gt;</span>
<span class="x">                    &lt;a href=&quot;</span><span class="cp">{{</span> <span class="nv">SITEURL</span> <span class="cp">}}</span><span class="x">/</span><span class="cp">{{</span> <span class="nv">article.url</span> <span class="cp">}}</span><span class="x">&quot; rel=&quot;bookmark&quot; title=&quot;Permalink to </span><span class="cp">{{</span> <span class="nv">article.title</span><span class="o">|</span><span class="nf">striptags</span> <span class="cp">}}</span><span class="x">&quot;&gt;</span><span class="cp">{{</span> <span class="nv">article.title</span> <span class="cp">}}</span><span class="x">&lt;/a&gt;</span>
<span class="x">                &lt;/div&gt;</span>
<span class="x">            &lt;/div&gt;</span>
<span class="x">            </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    &lt;/ul&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">&lt;/ul&gt;</span>
</pre></div>


<p><img alt="The groupby result" src="http://i.imgur.com/Ob65o4J.png" /></p>
<h3>Writing your first article</h3>
<p>Just create a <code>.md</code> file in the <code>content</code> folder, and write the metadata, followed by the actual Markdown formatted text:</p>
<div class="codehilite"><pre>Title: Migrating to a Pelican static blog
Date: 2013-04-06 02:24
Tags: static-blog, markdown, pelican, python, web-development, git, django
Category: programming
Slug: pelican-static-blog
Summary: How did I migrate my Django blog to a static one, using Pelican.

This is the content of my blog post. I should use Markdown here.
</pre></div>


<p>Save the file, run <code>make html</code>, and that's it.</p>
<h3>Deploying to your web server</h3>
<p>I have my Pelican project, <a href="https://github.com/sharkerz/thesoftjaguar">thesoftjaguar</a>, on Github. However, I don't intend to serve the static files there, because I already have a personal web server.</p>
<p>I am using a git post-hook to my personal web server, as explained in <a href="../../../../../posts/2012/02/29/deploying-applications-with-git/">Deploying applications with git</a>, so I have two remotes in my <code>thesoftjaguar</code> repository: github and my personal server. But the <code>post-receive</code> hook is going to be a bit different, because I only want to serve the <code>output</code> folder:</p>
<div class="codehilite"><pre><span class="nb">export </span><span class="nv">GIT_WORK_TREE</span><span class="o">=</span>/home/dario/git/tmp/thesoftjaguar

git checkout -f
git reset --hard
rm -rf /home/dario/www/*
cp -r <span class="s2">&quot;$GIT_WORK_TREE/thesoftjaguar/output/.&quot;</span> /home/dario/www/
</pre></div>


<p>And now we add the new remote:</p>
<div class="codehilite"><pre><span class="nv">$ </span>git remote add web dario@darioblanco.com:git/thesoftjaguar.git
<span class="nv">$ </span>git push web +master:refs/heads/master
</pre></div>


<p>From now on, the deployment is totally independent from the github repo, and is going to be extremely comfortable:</p>
<div class="codehilite"><pre><span class="nv">$ </span>git push web master
</pre></div></p>
</div><!-- /.entry-content -->
</article>
<hr>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'thesoftjaguar';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments.</a></noscript>
        <hr>
        <footer>
            &copy; Darío Blanco 2011-2013 - <a href="mailto:dario@darioblanco.com">dario@darioblanco.com</a>
        </footer>
    </div> <!-- /container -->

    <script src="../../../../../theme/js/bootstrap.min.js"></script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-27981742-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
</body>
</html>